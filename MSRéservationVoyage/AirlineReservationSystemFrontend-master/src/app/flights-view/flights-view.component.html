<app-loader></app-loader>
<div class="container mt-50">
  <div class="card">
    <div class="card-header">
      <h4>Réservez votre Vol</h4>
    </div>

    <ng-container *ngIf="state$ | async as state">
      <ng-container *ngIf="state?.data">
        <div class="card-body">
          <h5 class="card-title">Vols Disponibles</h5>
          <div class="card" *ngFor="let flight of state.data">
            <div class="flight-name">
              <span><strong>D'où partez-vous : </strong></span>
              <span>{{ flight?.route_id?.departure_city }}</span>
              <span>
                <img alt="vol" src="../assets/flight.png" />
              </span>
              <span><strong>Où allez-vous : </strong></span>
              <span>{{ flight?.route_id?.arrival_city }}</span>
            </div>
            <div class="flight-name">
              <span><strong>Départ le : </strong>{{ flight?.departure_time }}</span>
              <span class="ml-365"><strong>À : </strong>{{ flight?.arrival_time }}</span>
            </div>
            <div class="flight-name">
              <span><strong>Compagnie : </strong></span>
              <span>{{ flight?.company }}</span><br>
              <span><strong>Prix : </strong>{{ flight?.price }} €</span>
              <button type="button" class="btn btn-primary btn-lg float-right" (click)="selectDepartingFlight(flight)">Sélectionner</button>
            </div>
          </div>
        </div>
      </ng-container>
    </ng-container>

    <div class="card-body" *ngIf="booking.length > 0">
      <h5 class="card-title">Votre Réservation</h5>
      <div class="card" *ngFor="let flight of booking">
        <div class="flight-name">
          <span><strong>Départ de : </strong></span>
          <span>{{ flight?.trip_id?.route_id?.departure_city }}</span>
          <span>
            <img alt="vol" src="../assets/flight.png" />
          </span>
          <span><strong>Arrivée à : </strong></span>
          <span>{{ flight?.trip_id?.route_id?.arrival_city }}</span>
        </div>
        <div class="flight-name">
          <span><strong>À : </strong>{{ flight?.trip_id?.departure_time }}</span>
          <span class="ml-365"><strong>À : </strong>{{ flight?.trip_id?.arrival_time }}</span>
        </div>
        <div class="flight-name">
          <span><strong>Compagnie : </strong></span>
          <span>{{ flight?.trip_id?.plane_id?.company }}</span>
        </div>
        <div class="flight-name">
          <span><strong>Date actuelle du voyage : </strong></span>
          <span>{{ flight?.trip_id?.date }}</span>
        </div>
        <div class="form-group row margin-l">
          <label for="changedDate" class="col-sm-3 col-form-label form-label"><strong>Nouvelle date de voyage :</strong></label>
          <div class="col-sm-3">
            <input type="text" class="form-control" id="changedDate" #changedDate placeholder="Changer la date"
              list="dateList" autocomplete="off">
            <datalist id="dateList">
              <option *ngFor="let date of dates" value="{{ date?.date }}">{{ date?.departure_time }} - {{ date?.arrival_time }}</option>
            </datalist>
          </div>
        </div>
        <div class="float-right margin-l-b">
          <button type="button" class="btn btn-danger btn-lg float-left" (click)="cancelFlight()">Annuler la Réservation</button>
          <button type="button" class="btn btn-primary btn-lg float-right" (click)="selectFlight(changedDate.value)">Sélectionner</button>
        </div>
      </div>
      <div class="flight-name booked" *ngIf="booking?.length === 0">
        <span><strong>Réservation Supprimée</strong></span>
      </div>
    </div>

  </div>
</div>
